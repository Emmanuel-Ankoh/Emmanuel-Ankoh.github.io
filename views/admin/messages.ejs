<%- include('../partials/head', { title }) %>
<main id="main" class="container">
  <h1>Messages</h1>
  <table class="table">
    <thead>
      <tr>
        <th>Name</th>
        <th>Email</th>
        <th>Message</th>
        <th>Status</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <% (messages || []).forEach(m => { %>
        <tr>
          <td><%= m.name %></td>
          <td><a href="mailto:<%= m.email %>"><%= m.email %></a></td>
          <td style="max-width: 400px"><%= m.message %></td>
          <td><%= m.read ? 'Read' : 'Unread' %></td>
          <td>
            <% if (!m.read) { %>
              <form method="POST" action="/admin/messages/<%= m._id %>/read" style="display:inline">
                <button class="btn" type="submit">Mark Read</button>
              </form>
            <% } %>
            <form method="POST" action="/admin/messages/<%= m._id %>/delete" style="display:inline">
              <button class="btn danger" type="submit" onclick="return confirm('Delete this message?')">Delete</button>
            </form>
          </td>
        </tr>
      <% }) %>
    </tbody>
  </table>
</main>
<%- include('../partials/footer') %>
