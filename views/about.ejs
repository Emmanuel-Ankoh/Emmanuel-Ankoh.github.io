<%- include('partials/head', { title }) %>
<main id="main" class="container">
  <section>
    <h1>About Me</h1>
    <div class="about-grid">
      <img class="avatar" src="<%= (profile && profile.avatarUrl) || '/images/placeholder.svg' %>" alt="Portrait of <%= (site && site.name) || 'Your Name' %>" />
      <div>
        <h2 style="margin:.2rem 0 0 0"><%= (profile && profile.name) || (site && site.name) || 'Your Name' %></h2>
        <p class="subtitle" style="margin:.25rem 0 0 0"><%= (profile && profile.headline) || 'Full-Stack Developer' %></p>
        <% const loc = (profile && profile.location); const phone = (profile && profile.phone); const socials = (profile && profile.socials) || {}; const avail = profile && (typeof profile.availability === 'boolean') ? profile.availability : undefined; %>
        <% if (loc || socials.email || phone || typeof avail === 'boolean') { %>
          <ul class="meta" style="margin:.5rem 0 1rem 0;display:flex;gap:1rem;flex-wrap:wrap;color:var(--muted)">
            <% if (loc) { %><li>üìç <%= loc %></li><% } %>
            <% if (socials.email) { %><li>‚úâÔ∏è <a href="mailto:<%= socials.email %>"><%= socials.email %></a></li><% } %>
            <% if (phone) { %><li>‚òéÔ∏è <a href="tel:<%= phone %>"><%= phone %></a></li><% } %>
            <% if (typeof avail === 'boolean') { %><li><span class="badge"><%= avail ? 'Open to work' : 'Not available' %></span></li><% } %>
          </ul>
        <% } %>

            <% if (profile && profile.mission) { %>
              <p class="subtitle" style="margin:.5rem 0 1rem 0"><%= profile.mission %></p>
            <% } %>

        <% if (profile && profile.aboutBody) { %>
          <div><%- profile.aboutBody %></div>
        <% } else { %>
          <p>
            I'm a full-stack developer passionate about building user-centric products. I enjoy working across the stack, from clean UIs to resilient APIs.
          </p>
          <p>
            When I'm not coding, I read about distributed systems and contribute to open-source projects.
          </p>
        <% } %>

        <div class="toolbar" style="margin-top:1rem">
          <div></div>
          <div style="display:flex;gap:.5rem;flex-wrap:wrap">
            <a class="btn btn-primary" href="<%= (profile && profile.resumeUrl) || '/resume.pdf' %>" target="_blank" rel="noopener">Download Resume</a>
            <a class="btn" href="/contact">Contact</a>
            <% if (socials.email) { %><a class="btn" href="mailto:<%= socials.email %>">Email</a><% } %>
          </div>
        </div>
        <% if (socials.github || socials.linkedin || socials.twitter || socials.email) { %>
          <ul class="socials" style="margin-top:.75rem;display:flex;gap:.75rem;flex-wrap:wrap">
            <% if (socials.github) { %><li><a href="<%= socials.github %>" target="_blank" rel="noopener">GitHub</a></li><% } %>
            <% if (socials.linkedin) { %><li><a href="<%= socials.linkedin %>" target="_blank" rel="noopener">LinkedIn</a></li><% } %>
            <% if (socials.twitter) { %><li><a href="<%= socials.twitter %>" target="_blank" rel="noopener">Twitter</a></li><% } %>
            <% if (socials.instagram) { %><li><a href="<%= socials.instagram %>" target="_blank" rel="noopener">Instagram</a></li><% } %>
            <% if (socials.youtube) { %><li><a href="<%= socials.youtube %>" target="_blank" rel="noopener">YouTube</a></li><% } %>
            <% if (socials.stackoverflow) { %><li><a href="<%= socials.stackoverflow %>" target="_blank" rel="noopener">Stack Overflow</a></li><% } %>
            <% if (socials.email) { %><li><a href="mailto:<%= socials.email %>">Email</a></li><% } %>
          </ul>
        <% } %>
      </div>
    </div>
  </section>
  <section>
    <h2>Core Skills</h2>
        <% const skillGroups = (profile && Array.isArray(profile.skillGroups)) ? profile.skillGroups.filter(g => g && g.skills && g.skills.length) : []; %>
        <% if (skillGroups.length) { %>
          <div class="skill-groups" style="margin-top:1rem">
            <% skillGroups.forEach((group, idx) => { %>
              <article class="skill-group" data-aos="fade-up" <%= idx ? ('data-aos-delay="' + (idx*60) + '"') : '' %>>
                <h3><%= group.title || 'Skills' %></h3>
                <ul class="skills">
                  <% (group.skills || []).forEach(skill => { %>
                    <li><span><%= skill.name %></span><div class="bar"><span class="bar-fill" data-level="<%= Math.max(0, Math.min(100, skill.level||0)) %>"></span></div></li>
                  <% }) %>
                </ul>
              </article>
            <% }) %>
          </div>
          <% if (skillGroups.length > 0 || (profile.skills && profile.skills.length)) { %>
            <p style="margin-top:.75rem"><a class="btn" href="/skills">See full skills matrix</a></p>
          <% } %>
        <% } else if (profile && Array.isArray(profile.skills) && profile.skills.length) { %>
          <div class="skills-grid" style="margin-top:1rem">
            <div>
              <p>Here are a few of the technologies I work with regularly. Each bar reflects my current confidence level out of 100.</p>
            </div>
            <div>
              <ul class="skills">
                <% const sortedSkills = [...profile.skills].sort((a,b)=> (b.level||0)-(a.level||0)); %>
                <% sortedSkills.slice(0,8).forEach((s) => { %>
                  <li><span><%= s.name %></span><div class="bar"><span class="bar-fill" data-level="<%= Math.max(0, Math.min(100, s.level||0)) %>"></span></div></li>
                <% }) %>
              </ul>
              <% if (profile.skills.length > 8) { %>
                <p style="margin-top:.5rem"><a class="btn" href="/skills">See all skills</a></p>
              <% } %>
            </div>
          </div>
        <% } else { %>
          <p>Add skills in Admin ‚Üí Profile to showcase them here.</p>
        <% } %>
  </section>
  <section>
    <h2>Education & Experience</h2>
    <ol class="timeline">
      <% if (profile && Array.isArray(profile.timeline) && profile.timeline.length) { %>
        <% profile.timeline.forEach((item, idx) => { %>
          <li data-aos="fade-up" <%= idx ? ('data-aos-delay="' + (idx*80) + '"') : '' %>>
            <h3><%= item.title %></h3>
            <p><%= item.subtitle || '' %> ¬∑ <%= item.year || '' %></p>
            <% if (item.description) { %><p><%= item.description %></p><% } %>
          </li>
        <% }) %>
      <% } else { %>
        <li data-aos="fade-up">
          <h3>Software Engineer</h3>
          <p>Company ¬∑ 2023 ‚Äì Present</p>
        </li>
        <li data-aos="fade-up" data-aos-delay="100">
          <h3>B.Sc. Computer Science</h3>
          <p>University ¬∑ 2019 ‚Äì 2023</p>
        </li>
      <% } %>
    </ol>
  </section>
  <section>
    <h2>Testimonials</h2>
    <% const testimonials = (profile && Array.isArray(profile.testimonials)) ? profile.testimonials.filter(t => t.name && t.quote) : []; %>
    <% if (testimonials.length) { %>
      <div class="testimonials-grid" style="margin-top:1rem">
        <% testimonials.forEach((t, idx) => { %>
          <article class="testimonial-card" data-aos="fade-up" <%= idx ? ('data-aos-delay="' + (idx*60) + '"') : '' %>>
            <% if (t.avatarUrl) { %>
              <img src="<%= t.avatarUrl %>" alt="Portrait of <%= t.name %>" loading="lazy" decoding="async">
            <% } %>
            <blockquote>‚Äú<%= t.quote %>‚Äù</blockquote>
            <footer>
              <div>
                <strong><%= t.name %></strong>
                <% if (t.role) { %><span> ¬∑ <%= t.role %></span><% } %>
              </div>
              <% if (t.link) { %><a href="<%= t.link %>" target="_blank" rel="noopener">Source</a><% } %>
            </footer>
          </article>
        <% }) %>
      </div>
    <% } else { %>
      <p>Add testimonials to highlight client feedback and speaking engagements.</p>
    <% } %>
  </section>
</main>
<%- include('partials/footer') %>
